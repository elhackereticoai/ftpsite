<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index of /secure/documents/</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #1a1a2e;
            --bg-light: #16213e;
            --text-primary: #e8e8e8;
            --text-secondary: #8b9bb4;
            --accent: #4a9eff;
            --success: #2ecc71;
            --danger: #e74c3c;
            --border: #2d3748;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Login Page Styles */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .login-box {
            background: var(--bg-light);
            padding: 3rem;
            border-radius: 12px;
            border: 1px solid var(--border);
            width: 100%;
            max-width: 420px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .login-header p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .form-group input {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Fira Code', monospace;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .btn-login {
            width: 100%;
            padding: 1rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-login:hover {
            background: #3a8eef;
            transform: translateY(-2px);
        }

        .error-message {
            background: rgba(231, 76, 60, 0.15);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 0.875rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 0.875rem;
            display: none;
        }

        .server-info {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .server-info p {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-family: 'Fira Code', monospace;
        }

        /* Directory Listing Styles */
        .directory-container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .directory-header {
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .directory-header h1 {
            font-family: 'Fira Code', monospace;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .directory-header p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        .file-table {
            width: 100%;
            border-collapse: collapse;
        }

        .file-table th,
        .file-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .file-table th {
            font-family: 'Fira Code', monospace;
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .file-table tr {
            transition: background 0.2s;
        }

        .file-table tr:hover {
            background: rgba(74, 158, 255, 0.05);
        }

        .file-name {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .file-icon {
            width: 32px;
            height: 32px;
            object-fit: contain;
        }

        .file-link {
            color: var(--accent);
            text-decoration: none;
            font-family: 'Fira Code', monospace;
            font-size: 0.95rem;
            transition: color 0.2s;
        }

        .file-link:hover {
            color: #6ab4ff;
            text-decoration: underline;
        }

        .file-size,
        .file-date {
            color: var(--text-secondary);
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
        }

        .parent-dir .file-icon {
            filter: hue-rotate(180deg);
        }

        .logout-btn {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            border-color: var(--danger);
            color: var(--danger);
        }

        .breadcrumb {
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .breadcrumb span {
            color: var(--accent);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            color: var(--accent);
        }

        /* Download notification */
        .download-toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--success);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .download-toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        @media (max-width: 768px) {
            .file-table {
                font-size: 0.875rem;
            }
            .file-table th:nth-child(3),
            .file-table td:nth-child(3) {
                display: none;
            }
        }
    </style>
</head>
<body>

    <!-- LOGIN PAGE -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1>üîê Acceso Restringido</h1>
                <p>Directorio Seguro - Autenticaci√≥n Requerida</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Usuario</label>
                    <input type="text" id="username" autocomplete="username" placeholder="Ingrese su usuario">
                </div>
                
                <div class="form-group">
                    <label for="password">Contrase√±a</label>
                    <input type="password" id="password" autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <button type="submit" class="btn-login">Autenticar</button>
                
                <div id="errorMsg" class="error-message">
                    ‚ö†Ô∏è Credenciales inv√°lidas. Acceso denegado.
                </div>
            </form>
            
            <div class="server-info">
                <p>Apache/2.4.52 (Unix) Server</p>
                <p>Protected Directory - Level 3 Security</p>
            </div>
        </div>
    </div>

    <!-- DIRECTORY LISTING PAGE -->
    <div id="directoryPage" class="directory-container">
        <button class="logout-btn" onclick="logout()">Cerrar Sesi√≥n</button>
        
        <div class="directory-header">
            <h1 id="directoryTitle">Index of /secure/documents/</h1>
            <p>Apache/2.4.52 (Unix) Server - Directorio Protegido</p>
        </div>
        
        <div class="breadcrumb" id="breadcrumb">
            üìÅ <a href="#" onclick="navigateTo('root'); return false;">/secure/documents/</a>
        </div>
        
        <table class="file-table">
            <thead>
                <tr>
                    <th width="50%">Nombre</th>
                    <th width="25%">Tama√±o</th>
                    <th width="25%">√öltima Modificaci√≥n</th>
                </tr>
            </thead>
            <tbody id="fileList">
                <!-- Files will be populated by JavaScript -->
            </tbody>
        </table>
        
        <div class="server-info" style="margin-top: 3rem; text-align: left; border: none; padding-top: 2rem;">
            <p>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</p>
            <p>Apache/2.4.52 (Unix) Server - Port 443</p>
        </div>
    </div>

    <!-- Download notification toast -->
    <div id="downloadToast" class="download-toast">
        üì• Descarga iniciada: <span id="downloadFileName"></span>
    </div>

    <script>
        // ============================================
        // CREDENTIALS ENCRYPTED WITH ROT47 CIPHER
        // ROT47 is a printable ASCII substitution cipher
        // Not base64, not MD5 - harder to identify at first glance
        // ============================================
        // 
        // To decrypt: Apply ROT47 again (it's symmetric)
        // Encrypted user: >2?F6=  -> ROT47 -> manuel
        // Encrypted pass: sC)0a_aeP  -> ROT47 -> DrX_2026!
        // ============================================
        
        const ENCRYPTED_USER = ">2?F6=";
        const ENCRYPTED_PASS = "sC)0a_aeP";
        
        // File system structure
        // For PDF files: use actual file path (same directory as HTML)
        // For other files: use blob content
        const fileSystem = {
            'root': {
                path: '/secure/documents/',
                parent: null,
                files: [
                    { 
                        name: 'plan_maestro.pdf', 
                        type: 'file', 
                        size: '2.4 MB', 
                        date: '2024-12-15 14:32', 
                        icon: 'üìÑ', 
                        download: true,  // Real file download
                        url: './plan_maestro.pdf'  // Direct link to file in same directory
                    },
                    { name: 'backup_old', type: 'folder', size: '-', date: '2024-11-20 09:15', icon: 'üìÅ' },
                    { 
                        name: 'notas.txt', 
                        type: 'file', 
                        size: '1.2 KB', 
                        date: '2024-12-10 18:45', 
                        icon: 'üìÑ', 
                        content: 'NOTAS IMPORTANTES\n\n- Revisar credenciales de acceso\n- Actualizar certificados SSL\n- Backup semanal programado' 
                    }
                ]
            },
            'backup_old': {
                path: '/secure/documents/backup_old/',
                parent: 'root',
                files: [
                    { 
                        name: 'config.json', 
                        type: 'file', 
                        size: '4.8 KB', 
                        date: '2024-11-18 22:10', 
                        icon: 'üìÑ', 
                        content: '{\n  "servidor_oculto": "http://manuelgutierrez.tech/hidden.html",\n  "token": "a1b2c3d4e5f6"\n}' 
                    },
                    { 
                        name: 'db_backup.sql', 
                        type: 'file', 
                        size: '156 MB', 
                        date: '2024-11-15 03:45', 
                        icon: 'üóÑÔ∏è', 
                        content: '-- Database Backup\n-- Created: 2024-11-15 03:45:00\n\nCREATE DATABASE company_db;\nUSE company_db;\n\n-- Tables and data would be here' 
                    },
                    { name: 'old_logs', type: 'folder', size: '-', date: '2024-10-01 12:00', icon: 'üìÅ' }
                ]
            },
            'old_logs': {
                path: '/secure/documents/backup_old/old_logs/',
                parent: 'backup_old',
                files: [
                    { 
                        name: 'access.log', 
                        type: 'file', 
                        size: '2.1 MB', 
                        date: '2024-09-30 23:59', 
                        icon: 'üìã', 
                        content: '192.168.1.50 - - [30/Sep/2024:23:59:01] "GET /admin HTTP/1.1" 200 1234\n192.168.1.51 - - [30/Sep/2024:23:59:02] "POST /login HTTP/1.1" 200 567' 
                    },
                    { 
                        name: 'error.log', 
                        type: 'file', 
                        size: '856 KB', 
                        date: '2024-09-30 23:59', 
                        icon: 'üìã', 
                        content: '[30/Sep/2024:23:58:45] Error: Connection timeout\n[30/Sep/2024:23:58:46] Warning: High memory usage detected' 
                    }
                ]
            }
        };
        
        let currentDirectory = 'root';
        
        // ROT47 encryption/decryption function (symmetric)
        function rot47(str) {
            let result = '';
            for (let i = 0; i < str.length; i++) {
                let charCode = str.charCodeAt(i);
                if (charCode >= 33 && charCode <= 126) {
                    charCode = ((charCode - 33 + 47) % 94) + 33;
                }
                result += String.fromCharCode(charCode);
            }
            return result;
        }
        
        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userInput = document.getElementById('username').value;
            const passInput = document.getElementById('password').value;
            const errorDiv = document.getElementById('errorMsg');
            
            const encryptedUser = rot47(userInput);
            const encryptedPass = rot47(passInput);
            
            if (encryptedUser === ENCRYPTED_USER && encryptedPass === ENCRYPTED_PASS) {
                sessionStorage.setItem('authenticated', 'true');
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('directoryPage').style.display = 'block';
                renderDirectory('root');
            } else {
                errorDiv.style.display = 'block';
                const loginBox = document.querySelector('.login-box');
                loginBox.style.animation = 'none';
                loginBox.offsetHeight;
                loginBox.style.animation = 'shake 0.5s ease-in-out';
            }
        });
        
        // Logout function
        function logout() {
            sessionStorage.removeItem('authenticated');
            document.getElementById('directoryPage').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('errorMsg').style.display = 'none';
            currentDirectory = 'root';
        }
        
        // Check if already authenticated
        window.addEventListener('load', function() {
            if (sessionStorage.getItem('authenticated') === 'true') {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('directoryPage').style.display = 'block';
                renderDirectory('root');
            }
        });
        
        // Render directory contents
        function renderDirectory(dirKey) {
            currentDirectory = dirKey;
            const dir = fileSystem[dirKey];
            const fileList = document.getElementById('fileList');
            const directoryTitle = document.getElementById('directoryTitle');
            const breadcrumb = document.getElementById('breadcrumb');
            
            directoryTitle.textContent = `Index of ${dir.path}`;
            
            let breadcrumbHTML = 'üìÅ ';
            if (dir.parent) {
                breadcrumbHTML += `<a href="#" onclick="navigateTo('root'); return false;">/secure/documents/</a>`;
                if (dirKey === 'backup_old') {
                    breadcrumbHTML += ` / <span style="color: var(--accent);">backup_old/</span>`;
                } else if (dirKey === 'old_logs') {
                    breadcrumbHTML += ` / <a href="#" onclick="navigateTo('backup_old'); return false;">backup_old/</a> / <span style="color: var(--accent);">old_logs/</span>`;
                }
            } else {
                breadcrumbHTML += `<a href="#" onclick="navigateTo('root'); return false;">/secure/documents/</a>`;
            }
            breadcrumb.innerHTML = breadcrumbHTML;
            
            let html = '';
            
            if (dir.parent) {
                html += `
                    <tr class="parent-dir">
                        <td>
                            <div class="file-name">
                                <span class="file-icon">üìÅ</span>
                                <a href="#" class="file-link" onclick="navigateTo('${dir.parent}'); return false;">Parent Directory/</a>
                            </div>
                        </td>
                        <td class="file-size">-</td>
                        <td class="file-date">-</td>
                    </tr>
                `;
            }
            
            dir.files.forEach(file => {
                const isFolder = file.type === 'folder';
                const icon = isFolder ? 'üìÅ' : getFileIcon(file.name);
                
                let onClick = '';
                let href = '';
                
                if (isFolder) {
                    onClick = `onclick="navigateTo('${file.name}'); return false;"`;
                } else if (file.download) {
                    // Real file download - use direct href
                    href = `href="${file.url}" download`;
                } else {
                    // Simulated file download with blob
                    onClick = `onclick="downloadFile('${file.name}', '${dirKey}'); return false;"`;
                }
                
                html += `
                    <tr>
                        <td>
                            <div class="file-name">
                                <span class="file-icon">${icon}</span>
                                <a ${href} class="file-link" ${onClick}>${file.name}${isFolder ? '/' : ''}</a>
                            </div>
                        </td>
                        <td class="file-size">${file.size}</td>
                        <td class="file-date">${file.date}</td>
                    </tr>
                `;
            });
            
            fileList.innerHTML = html;
        }
        
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'pdf': 'üìÑ',
                'json': 'üìÑ',
                'txt': 'üìÑ',
                'sql': 'üóÑÔ∏è',
                'log': 'üìã'
            };
            return icons[ext] || 'üìÑ';
        }
        
        function navigateTo(dirKey) {
            if (fileSystem[dirKey]) {
                renderDirectory(dirKey);
            }
        }
        
        // Download simulated file with blob content
        function downloadFile(filename, dirKey) {
            const dir = fileSystem[dirKey];
            const file = dir.files.find(f => f.name === filename);
            
            if (file && file.content) {
                const blob = new Blob([file.content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                window.URL.revokeObjectURL(url);
                
                showDownloadToast(filename);
            }
        }
        
        function showDownloadToast(filename) {
            const toast = document.getElementById('downloadToast');
            const fileNameSpan = document.getElementById('downloadFileName');
            fileNameSpan.textContent = filename;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Add shake animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>

